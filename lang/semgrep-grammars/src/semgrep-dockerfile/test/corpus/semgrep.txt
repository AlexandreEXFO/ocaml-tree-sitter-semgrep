=============================================
Inter-instruction ellipsis
=============================================

RUN a
...
RUN b

---

(source_file
  (run_instruction
    (shell_command
      (shell_fragment)))
  (semgrep_ellipsis)
  (run_instruction
    (shell_command
      (shell_fragment))))

=============================================
Whole-instruction metavariable
=============================================

RUN a
$INSTR
RUN b

---

(source_file
  (run_instruction
    (shell_command
      (shell_fragment)))
  (semgrep_metavariable)
  (run_instruction
    (shell_command
      (shell_fragment))))

=============================================
Array ellipsis
=============================================

RUN ["a", ..., "b"]

---

(source_file
  (run_instruction
    (string_array
      (double_quoted_string)
      (semgrep_ellipsis)
      (double_quoted_string))))

=============================================
Array metavariable
=============================================

RUN ["a", $X, "b"]

---

(source_file
  (run_instruction
    (string_array
      (double_quoted_string)
      (semgrep_metavariable)
      (double_quoted_string))))

=============================================
Param metavariable
=============================================

FROM --platform=$PLATFORM debian
ADD --chown=$USER_GROUP src dst

---

(source_file
  (from_instruction
    (param)
    (image_spec
      (image_name)))
  (add_instruction
    (param)
    (path)
    (path)))
